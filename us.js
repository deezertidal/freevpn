
`
ğŸ¤– æœ¬è„šæœ¬è½¬æ¢è‡ªï¼šhttps://greasyfork.org/scripts/435698-å…¨ç½‘vipè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨-å·²é€‚é…æ‰‹æœº/code/å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.jsã€‚
ğŸ˜ è½¬æ¢å™¨ by Peng-YMã€‚TGé¢‘é“: https://t.me/cool_scripts

ğŸ”˜ [åŠŸèƒ½]
æ— éœ€è·³è½¬æ–°ç½‘å€ï¼Œæ‰“å¼€å®˜ç½‘ç›´æ¥çœ‹ï¼Œè¶…æ¸… æ— å¹¿å‘Š éšæœºå»æ°´å°ã€‚æ”¯æŒï¼šè…¾è®¯ï¼Œçˆ±å¥‡è‰ºï¼Œä¼˜é…·ï¼Œå“”å“©å“”å“©ï¼Œå’ªå’•ï¼Œä¹è§†ï¼Œæœç‹ï¼ŒèŠ’æœï¼Œè¥¿ç“œï¼ŒPPTVï¼Œ1905ç”µå½±ç½‘ï¼Œåæ•°ã€‚æ”¯æŒè§£æå¤±è´¥è‡ªåŠ¨åˆ‡æ¢æ¨èè§£ææºã€‚é€‚é…å„ç§æµè§ˆå™¨ï¼Œé…·ç¿i5-8300 CPUæ€§èƒ½æµ‹è¯•æ¶ˆè€—ä»…1%ã€‚

ğŸ›  [é…ç½®]
è¯·æ ¹æ®ä¸‹æ–¹æè¿°è®¾ç½®MITMåŸŸåå’Œé‡å†™ã€‚â—ï¸ç”±äºè„šæœ¬æ˜¯è‡ªåŠ¨ç”Ÿæˆï¼Œå¯èƒ½éœ€è¦æ‰‹åŠ¨è°ƒæ•´è®¾ç½®ã€‚


[MITM]
hostname=v\.qq\.com/.*, m\.v\.qq\.com/.*, .*\.iqiyi\.com/.*, .*\.youku\.com/.*, .*\.bilibili\.com/.*, .*\.miguvideo\.com/.*, .*\.le\.com/.*, tv\.sohu\.com/.*, film\.sohu\.com/.*, m\.tv\.sohu\.com/.*, .*\.mgtv\.com/.*, .*\.ixigua\.com/.*, .*\.pptv\.com/.*, vip\.1905\.com/.*, www\.wasu\.cn/.*, .*\..*/.*url=http.*://.*\..*\..*/.*, .*\..*:.*/.*url=http.*://.*\..*\..*/.*, .*\..*/.*v=http.*://.*\..*\..*/.*, .*\..*:.*/.*v=http.*://.*\..*\..*/.*, api\.leduotv\.com/.*?vid=.*, 

ğŸ”˜ Quantumult X
[rewrite_local]
v\.qq\.com/.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js
m\.v\.qq\.com/.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js
.*\.iqiyi\.com/.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js
.*\.youku\.com/.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js
.*\.bilibili\.com/.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js
.*\.miguvideo\.com/.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js
.*\.le\.com/.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js
tv\.sohu\.com/.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js
film\.sohu\.com/.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js
m\.tv\.sohu\.com/.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js
.*\.mgtv\.com/.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js
.*\.ixigua\.com/.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js
.*\.pptv\.com/.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js
vip\.1905\.com/.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js
www\.wasu\.cn/.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js
.*\..*/.*url=http.*://.*\..*\..*/.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js
.*\..*:.*/.*url=http.*://.*\..*\..*/.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js
.*\..*/.*v=http.*://.*\..*\..*/.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js
.*\..*:.*/.*v=http.*://.*\..*\..*/.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js
api\.leduotv\.com/.*?vid=.* url script-response-body å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js.js


ğŸ”˜ Loon
[Script]
http-response v\.qq\.com/.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js
http-response m\.v\.qq\.com/.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js
http-response .*\.iqiyi\.com/.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js
http-response .*\.youku\.com/.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js
http-response .*\.bilibili\.com/.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js
http-response .*\.miguvideo\.com/.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js
http-response .*\.le\.com/.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js
http-response tv\.sohu\.com/.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js
http-response film\.sohu\.com/.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js
http-response m\.tv\.sohu\.com/.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js
http-response .*\.mgtv\.com/.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js
http-response .*\.ixigua\.com/.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js
http-response .*\.pptv\.com/.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js
http-response vip\.1905\.com/.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js
http-response www\.wasu\.cn/.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js
http-response .*\..*/.*url=http.*://.*\..*\..*/.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js
http-response .*\..*:.*/.*url=http.*://.*\..*\..*/.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js
http-response .*\..*/.*v=http.*://.*\..*\..*/.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js
http-response .*\..*:.*/.*v=http.*://.*\..*\..*/.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js
http-response api\.leduotv\.com/.*?vid=.* script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, tag=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js


ğŸ”˜ Surge
[Script]
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=v\.qq\.com/.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=m\.v\.qq\.com/.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=.*\.iqiyi\.com/.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=.*\.youku\.com/.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=.*\.bilibili\.com/.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=.*\.miguvideo\.com/.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=.*\.le\.com/.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=tv\.sohu\.com/.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=film\.sohu\.com/.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=m\.tv\.sohu\.com/.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=.*\.mgtv\.com/.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=.*\.ixigua\.com/.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=.*\.pptv\.com/.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=vip\.1905\.com/.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=www\.wasu\.cn/.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=.*\..*/.*url=http.*://.*\..*\..*/.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=.*\..*:.*/.*url=http.*://.*\..*\..*/.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=.*\..*/.*v=http.*://.*\..*\..*/.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=.*\..*:.*/.*v=http.*://.*\..*\..*/.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720
å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js=type=http-response, pattern=api\.leduotv\.com/.*?vid=.*, script-path=å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js, requires-body=true, max-size=1310720


`
try {
    let body = $response.body;
    if (/<\/html>|<\/body>/.test(body)) {
        body = body.replace('</body>', `<script>
 const result=function(){
function GM_deleteValue(e){return new Promise((t,n)=>{chrome.runtime.sendMessage({key:e,name:"ApiDeleteValue",uuid:_uuid},e=>e?t():n())})}function GM_getValue(e,t){return new Promise(n=>{chrome.runtime.sendMessage({key:e,name:"ApiGetValue",uuid:_uuid},e=>{n(void 0!==e?e:t)})})}function GM_listValues(){return new Promise(e=>{chrome.runtime.sendMessage({name:"ApiListValues",uuid:_uuid},t=>e(t))})}function GM_setValue(e,t){return new Promise((n,r)=>{chrome.runtime.sendMessage({key:e,name:"ApiSetValue",uuid:_uuid,value:t},e=>{void 0!==e?n(e):(console.warn("set value failed:",chrome.runtime.lastError),r())})})}function GM_getResourceUrl(e){return new Promise((t,n)=>{chrome.runtime.sendMessage({name:"ApiGetResourceBlob",resourceName:e,uuid:_uuid},r=>{r?t(URL.createObjectURL(r.blob)):n("No resource named "+e)})})}function GM_notification(e,t,n,r){let o;if("object"==typeof e?(o=e,"function"==typeof t&&(o.ondone=t)):o={title:t,text:e,image:n,onclick:r},"string"!=typeof o.text)throw new Error(_("gm_notif_text_must_be_string"));"string"!=typeof o.title&&(o.title=_("extName")),"string"!=typeof o.image&&(o.image="skin/icon.svg");let i=chrome.runtime.connect({name:"UserScriptNotification"});i.onMessage.addListener(e=>{const t=e.type;"function"==typeof o[t]&&o[t]()}),i.postMessage({details:{title:o.title,text:o.text,image:o.image},name:"create",uuid:_uuid})}function GM_openInTab(e,t){let n;try{n=new URL(e,location.href)}catch(t){throw new Error(_("gm_opentab_bad_URL",e))}chrome.runtime.sendMessage({active:!1===t,name:"ApiOpenInTab",url:n.href,uuid:_uuid})}function GM_setClipboard(e){document.addEventListener("copy",function t(n){document.removeEventListener("copy",t,!0),n.stopImmediatePropagation(),n.preventDefault(),n.clipboardData.setData("text/plain",e)},!0),document.execCommand("copy")}function GM_xmlHttpRequest(e){if(!e)throw new Error(_("xhr_no_details"));if(!e.url)throw new Error(_("xhr_no_url"));let t;try{t=new URL(e.url,location.href)}catch(t){throw new Error(_("xhr_bad_url",e.url,t))}if("http:"!=t.protocol&&"https:"!=t.protocol&&"ftp:"!=t.protocol)throw new Error(_("xhr_bad_url_scheme",e.url));let n=chrome.runtime.connect({name:"UserScriptXhr"});n.onMessage.addListener(function(t){if(t.responseState.responseXML)try{t.responseState.responseXML=(new DOMParser).parseFromString(t.responseState.responseText,"application/xml")}catch(e){console.warn("GM_xhr could not parse XML:",e),t.responseState.responseXML=null}let n=("up"==t.src?e.upload:e)["on"+t.type];n&&n(t.responseState)});let r={};Object.keys(e).forEach(t=>{let n=e[t];r[t]=n,"function"==typeof n&&(r[t]=!0)}),r.upload={},e.upload&&Object.keys(e=>r.upload[e]=!0),r.url=t.href,n.postMessage({details:r,name:"open",uuid:_uuid})}
// ==UserScript==
// @name         å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº)
// @namespace    https://www.tampermonkey.net/
// @version      0.8.13.3
// @license      AGPL-3.0
// @description  æ— éœ€è·³è½¬æ–°ç½‘å€ï¼Œæ‰“å¼€å®˜ç½‘ç›´æ¥çœ‹ï¼Œè¶…æ¸… æ— å¹¿å‘Š éšæœºå»æ°´å°ã€‚æ”¯æŒï¼šè…¾è®¯ï¼Œçˆ±å¥‡è‰ºï¼Œä¼˜é…·ï¼Œå“”å“©å“”å“©ï¼Œå’ªå’•ï¼Œä¹è§†ï¼Œæœç‹ï¼ŒèŠ’æœï¼Œè¥¿ç“œï¼ŒPPTVï¼Œ1905ç”µå½±ç½‘ï¼Œåæ•°ã€‚æ”¯æŒè§£æå¤±è´¥è‡ªåŠ¨åˆ‡æ¢æ¨èè§£ææºã€‚é€‚é…å„ç§æµè§ˆå™¨ï¼Œé…·ç¿i5-8300 CPUæ€§èƒ½æµ‹è¯•æ¶ˆè€—ä»…1%ã€‚
// @author       Tenfond
// @include      http*://v.qq.com/*
// @include      http*://m.v.qq.com/*
// @include      http*://*.iqiyi.com/*
// @include      http*://*.youku.com/*
// @include      http*://*.bilibili.com/*
// @include      http*://*.miguvideo.com/*
// @include      http*://*.le.com/*
// @include      http*://tv.sohu.com/*
// @include      http*://film.sohu.com/*
// @include      http*://m.tv.sohu.com/*
// @include      http*://*.mgtv.com/*
// @include      http*://*.ixigua.com/*
// @include      http*://*.pptv.com/*
// @include      http*://vip.1905.com/*
// @include      http*://www.wasu.cn/*
// @include      http*://*.*/*url=http*://*.*.*/*
// @include      http*://*.*:*/*url=http*://*.*.*/*
// @include      http*://*.*/*v=http*://*.*.*/*
// @include      http*://*.*:*/*v=http*://*.*.*/*
// @include      http*://api.leduotv.com/*?vid=*
// @grant        GM_getValue
// @grant        GM_setValue
// @run-at       document-body
// ==/UserScript==
/**
 * ä»»åŠ¡æ¸…å•ï¼š
 */

// æœ‰ä»»ä½•é—®é¢˜éƒ½å¯ä»¥è”ç³»æˆ‘é‚®ç®± tenfond@outlook.com

setTimeout(() => {
    'use strict';

    // è¯»å–é…ç½®åæ‰§è¡Œ
    function readSettings() {
        // è·å–æ¡†æ¶å¾ªç¯æ—¶é—´ï¼ŒCPUæ€§èƒ½å¥½çš„å¯ä»¥è®¾ç½®ä¸º100ï¼ŒCPUæ€§èƒ½ä¸å¥½çš„å¯ä»¥è®¾ç½®ä¸º1000
        settings.getElementTimes = 500;
        // logè¾“å‡ºå­—ä½“å¸ƒå±€
        settings.fontStyle = {
            error: "font-family: å¾®è½¯é›…é»‘,é»‘ä½“,Droid Serif,Arial,sans-serif; color: #f00;",
            warn: "font-family: å¾®è½¯é›…é»‘,é»‘ä½“,Droid Serif,Arial,sans-serif; color: #ff0;",
            ok: "font-family: å¾®è½¯é›…é»‘,é»‘ä½“,Droid Serif,Arial,sans-serif; color: #0f0;",
            maxTip: "font-family: å¾®è½¯é›…é»‘,é»‘ä½“,Droid Serif,Arial,sans-serif; font-size: 30px; background-color: #222; text-shadow: 0px 0px 12px #fff; color: #fff;"
        };

        if (window === top) {
            /*
            *    (): å°æ‹¬å·æ‹¬ä½çš„è¡¨ç¤ºæ¨èè§£æ ç”»è´¨é«˜ é€Ÿåº¦å¿«
            *    : æ— æ‹¬å·çš„è¡¨ç¤ºè§†é¢‘å¸¦æ°´å° æˆ– åŸé¡µé¢ç”»è´¨
            *    []: æ–¹æ‹¬å·è¡¨ç¤ºæ ‡æ¸…ç”»è´¨ ä¸æ¨è
            */
            settings.NoADè§£æ = {    // TODO by 17kyun.com/api.php?url=    // TODO by tv.hzwdd.cn
                // ä½ å¯ä»¥åœ¨è¿™é‡Œå®šä¹‰è‡ªå·±çš„è§£ææ¥å£ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨é€‚é…ã€‚æ ¼å¼å¦‚ä¸‹ï¼š
                // "è§£æåç§°": "è§£ææ¥å£çš„é“¾æ¥",             // TODO æ³¨æ„ : å’Œ " ä»¥åŠ , éƒ½æ˜¯è‹±æ–‡çš„ç¬¦å·ã€‚
                "JYè§£æ": "https://jx.playerjy.com/?url=",    // TODO (å¾…æµ‹è¯•)
                "TVè§£æ": "https://jx.m3u8.tv/jiexi/?url=",    // TODO è…¾è®¯ (èŠ’æœ)
                "å¤©ç¿¼è§£æ": "https://jsap.attakids.com/?url=",    // TODO è…¾è®¯ (èŠ’æœ) (Bç«™)
                "çˆ±è§£æ": "https://jiexi.t7g.cn/?url=",    // TODO è…¾è®¯ (èŠ’æœ)
                "OKè§£æ": "https://api.okjx.cc:3389/jx.php?url=" || "https://okjx.cc/?url=" || "https://m2090.com/?url=",    // TODO ä¼˜è´¨: è…¾è®¯ (çˆ±å¥‡è‰º) ä¼˜é…· ä¹è§† èŠ’æœ PPTV (åæ•°)
                "å…¨æ°‘è§£æ": "https://jx.quanmingjiexi.com/?url=" || "https://chaxun.truechat365.com/?url=",    // TODO å·²å¤±æ•ˆ
                "äº‘è§£æ": "https://jx.aidouer.net/?url=" || "https://jx.ppflv.com/?url=",    // TODO è…¾è®¯ [çˆ±å¥‡è‰º] ä¼˜é…· (ä¹è§†) èŠ’æœ (1905ç”µå½±ç½‘) [åæ•°]
                // "ä¹…æ’­è§£æ": "https://jx.jiubojx.com/vip/?url=" || "https://www.qianyicp.com/vip/vip_g.php?url=",    // _4Kè§£æ: "https://vip.jx4k.com/vip/?url=",    // TODO å·²å¤±æ•ˆ
                "è™¾ç±³è§£æ": "https://jx.xmflv.com/?url=" || "https://nbjx.vip/index.php?url=",    // TODO (åœŸè±†) (å’ªå’•) æœç‹ (èŠ’æœ)
                "å¤œå¹•è§£æ": "https://www.yemu.xyz/?url="    // (Parwixè§£æ: "https://jx.parwix.com:4433/player/analysis.php?v=" || "https://vip.parwix.com:4433/player/?url=" || )    // TODO (è¥¿ç“œ) (Bç«™) (æœç‹) (èŠ’æœ)
                // "äº‘åšè§£æ": "https://jx.yunboys.cn/?url="    // TODO å·²å¤±æ•ˆ    // by www.yunboys.cn
            };
            settings.ADè§£æ = {    // TODO (æœ‰èµŒåšå¹¿å‘Šï¼Œè¯·å‹¿ç›¸ä¿¡ï¼Œè¿™ä¹ˆç®€å•çš„éª—æœ¯ä¸ä¼šæœ‰äººä¸Šå½“å§)
                "è¯ºè®¯è§£æ": "https://www.nxflv.com/?url=",    // TODO (è…¾è®¯) (çˆ±å¥‡è‰º) (ä¼˜é…·)
                "z1è§£æ": "https://z1.m1907.cn?jx=",
                "ä¹å¤šè§£æ": "https://api.leduotv.com/wp-api/ifr.php?isDp=1&vid=",    // TODO (Bç«™)
                "Maoè§£æ": "https://www.mtosz.com/m3u8.php?url="    // TODO æ— æ°´å°(ä½†ä¸ç¨³å®š): è…¾è®¯ çˆ±å¥‡è‰º ä¼˜é…· ä¹è§† [èŠ’æœ] (PPTV) (åæ•°)
            };
            start();
        } else if (settings.isParse) {
            top.postMessage(key.ENCRYPT("å®å¡”é•‡æ²³å¦–\x00ç»™äºˆ\x000\x00" + location.href, settings.k1, settings.k2), "*");
            Object.defineProperty(console, "clear", {
                value: () => console.log("%cç¦æ­¢æ¸…é™¤æ§åˆ¶å°", settings.fontStyle.error), writable: false
            });
            settings.parseDB = new Promise(resolve => {
                window.addEventListener("message", event => {
                    if (event.source !== window) {
                        try {
                            let sql = key.DECRYPT(event.data, settings.k1, settings.k2).split("\x00");
                            if (sql[0] === "å¤©ç‹ç›–åœ°è™") {
                                if (sql[1] === "ç»™äºˆ") {
                                    if (sql[2] === "ç”¨æˆ·æ•°æ®åº“") {
                                        resolve(JSON.parse(sql[3]));
                                    }
                                }
                            }
                        } catch (e) {
                            // æ’é™¤ ä¸‹æ ‡è¶Šç•Œé”™è¯¯ åŠ æŒ‡ä»¤å¤„ç†é”™è¯¯
                        }
                    }
                });
            });
            // éœ€è¦å…ˆç›‘å¬å†å‘é€æ•°æ®
            top.postMessage(key.ENCRYPT("å®å¡”é•‡æ²³å¦–\x00è¯·æ±‚\x00ç”¨æˆ·æ•°æ®åº“", settings.k1, settings.k2), "*");
            start();
        }
    }

// æœªç»è®¸å¯ç¦æ­¢æŠ„è¢­ç®—æ³•ï¼Œå¯ä»¥ç§ç”¨ã€‚
    const key = (() => {
        // æ–°æ–¹æ¡ˆå®šä¹‰ç§æœ‰å˜é‡ã€‚ä¿®å¤éƒ¨åˆ†æµè§ˆå™¨ä¸æ”¯æŒ # å®šä¹‰privateç§æœ‰å˜é‡
        const password = Symbol();
        const randomkey = Symbol();

        // è‡ªå®šä¹‰åŠ å¯†ç®—æ³•ï¼Œä»¥é˜²æ•°æ®åŒ…è¢«ç ´è§£ã€‚
        class key {
            // _pwd;        // ç«ç‹v68ç‰ˆæœ¬è²Œä¼¼ä¸æ”¯æŒè¿™ç§æ–¹å¼å£°æ˜å˜é‡ã€‚

            constructor(pwd = null) {
                // numï¼Œå¯†ç åç§»é‡
                // keyï¼Œæ’åˆ—é•¿åº¦åç§»é‡
                // charCodeï¼Œé˜²æ­¢å†…å­˜é¢‘ç¹è¿åŠ¨ï¼Œå®šä¹‰åœ¨å¤–éƒ¨
                let num = 7, charCode, key = 7;
                if (pwd) {
                    if (typeof pwd === "string") {
                        for (let i = 0; i < pwd.length; i++) {
                            // å°†pwdä¸­ æ¯ä¸ªå­— è½¬æ¢æˆ åè¿›åˆ¶ASCIIå€¼
                            charCode = pwd[i].charCodeAt();
                            // å°†æ¯ä¸ª ASCIIå€¼ ä¸­ ç¬¬ä¸€ä¸ªå€¼åŠ å…¥åˆ° æ’åˆ—é•¿åº¦åç§»é‡
                            key += parseInt(charCode.toString()[0]);
                            // ç”¨ hashç®—æ³• å°† ASCIIå€¼ å‡å» 31 ä½œä¸ºæ–°çš„å€¼åŠ å…¥åˆ°numä¸­
                            // ä»¥ä¸‹æ–¹æ³•æ˜¯ä¸ºäº†é˜²æ­¢å‡ºç°è´Ÿæ•°ï¼ŒASCIIå­—ç¬¦é›†ä¸€å…±æœ‰65536ä¸ªå­—ç¬¦
                            // num += charCode - 31 => (charCode + 65505) % 65536
                            num = 31 * num + (charCode + 65505) % 65536;
                        }
                    } else if (typeof pwd === "number") {
                        // å¦‚æœå¯†ç æ˜¯æ•°å€¼å‹å°±ä½¿ç”¨æ­¤æ–¹æ³•ä½œä¸º å¯†ç åç§»é‡ å’Œ æ’åˆ—é•¿åº¦åç§»é‡
                        num = key = 7 + parseInt(Math.abs(pwd));
                    } else {
                        // å¦‚æœç±»å‹ä¸åŒ¹é…å°±ç›´æ¥æå‡ºé”™è¯¯
                        console.error("Unsupported type '" + (typeof pwd) + "'. It only supports 'string' or 'number'.")
                    }
                }
                // è®©æ’åˆ—é•¿åº¦åç§»é‡çš„è½¬æ¢æˆ8è¿›åˆ¶ï¼Œå–ç¬¬ä¸€ä¸ªæ•°å­—ã€‚åŠ ä¸Šå¯†ç è½¬æ¢æˆå­—ç¬¦å­—ç¬¦ä¸²çš„æ–¹å¼ã€‚æ•°å€¼+å­—ç¬¦ä¸² ä¼šå°†æ•°å€¼è‡ªåŠ¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²
                this[password] = key.toString(8)[0] + (num % 65536).toString();
            }

            encrypt(string) {
                if (string) {
                    // subStart æ’åˆ—é•¿åº¦çš„èµ·å§‹ä½ç½®ã€‚subIndex æ’åˆ—é•¿åº¦ã€‚ encryptPool åŠ å¯†æ± ï¼Œå³å»é™¤çš„æ’åˆ—é•¿åº¦å­˜æ”¾åœ¨è¿™é‡Œã€‚result åŠ å¯†åçš„ç»“æœã€‚
                    let subStart = string.length, subIndex = parseInt(this[password][0]) + 3, encryptPool = [],
                        result = "";
                    // stringKey åŠ å¯†å­—ç¬¦åç§»é‡çš„æ•£åˆ—å€¼çš„çš„ä¸ªæ•°ã€‚
                    let stringKey = subStart + parseInt(this[password].substring(1));
                    // stringKeyFloat åŠ å¯†å­—ç¬¦åç§»é‡çš„åç§»å•ä½ã€‚stringKeyIndex åŠ å¯†å­—ç¬¦åç§»é‡çš„ä½ç½®
                    let stringKeyFloat = 65536 / stringKey, stringKeyIndex = stringKey - 1;
                    // è·å–åŠ å¯†æ± ã€‚
                    while (subStart > subIndex) {
                        subStart -= subIndex;
                        encryptPool.push(string.substr(subStart, subIndex));
                    }
                    encryptPool.push(string.substring(0, subStart));
                    // å¯¹åŠ å¯†æ± è¿›è¡ŒåŠ å¯†ï¼Œå¹¶å°†åŠ å¯†çš„å­—ç¬¦çš„ç»“æœæ”¾å…¥ result ä¸­ã€‚
                    for (let i = 0, j; i < subIndex; i++) {
                        for (j = 0; j < encryptPool.length; j++) {
                            let char = encryptPool[j][i];
                            if (char) {
                                // å°†å­—ç¬¦çš„ ASCIIå€¼ åç§» æŒ‡å®šé‡
                                result += String.fromCharCode((char.charCodeAt() + parseInt(stringKeyFloat * (stringKeyIndex % 2 === 0 ? stringKeyIndex : stringKey - stringKeyIndex))) % 65536);
                                stringKeyIndex = stringKeyIndex === 0 ? stringKey - 1 : stringKeyIndex - 1;
                            } else {
                                break;
                            }
                        }
                    }
                    // è¿”å›åŠ å¯†ç»“æœ
                    return result;
                } else {
                    // å¦‚æœåŠ å¯†å­—ç¬¦ä¸²ä¸å­˜åœ¨å°±è¿”å›ç©ºå­—ç¬¦ä¸²
                    return "";
                }
            }

            /* å‡è®¾æœ‰7ä¸ªå­—ç¬¦

             åŠ å¯†å‰ - æ’åˆ—
             ( 1 )  ( 2  3 )  ( 4  5 ) ( 6  7 )

             åŠ å¯†ä¸­ - æ’åˆ—
             ï¸µ   ï¸µ   ï¸µ    ï¸µ
             6    4    2    1
             7    5    3    ï¸¶
             ï¸¶   ï¸¶   ï¸¶
             åŠ å¯†å - æ’åˆ—
             ( 6  4  2  1 )  ( 7  5  3 )

             è§£å¯†ä¸­ - æ’åˆ—
             ï¸µ   ï¸µ
             6    7
             4    5
             2    3
             1    ï¸¶
             ï¸¶
             è§£å¯†å - æ’åˆ—
             1  2  3  4  5  6  7  8
            */

            decrypt(string) {
                if (string) {
                    // subStart æ’åˆ—é•¿åº¦çš„èµ·å§‹ä½ç½®ã€‚desubIndex åå‘å–åŠ å¯†æ± çš„é•¿åº¦ã€‚ decryptPool è§£å¯†æ± ã€‚
                    let subStart = 0, desubIndex = Math.ceil(string.length / (parseInt(this[password][0]) + 3)),
                        //NullCount åŠ å¯†æ± ä¸­æœ€åä¸€ä¸ªå…ƒç´ çš„å…ƒç´ ç©ºä½ã€‚ desubIndex åå‘å–åŠ å¯†æ± çš„é•¿åº¦ã€‚ decryptPool è§£å¯†æ± ï¼Œresult è§£å¯†åçš„ç»“æœã€‚
                        NullCount = string.length % (parseInt(this[password][0]) + 3), decryptPool = [], result = "";
                    // stringKey åŠ å¯†å­—ç¬¦åç§»é‡çš„æ•£åˆ—å€¼çš„çš„ä¸ªæ•°ã€‚
                    let stringKey = string.length + parseInt(this[password].substring(1)), // stringKeyFloat åŠ å¯†å­—ç¬¦åç§»é‡çš„åç§»å•ä½ã€‚stringKeyIndex åŠ å¯†å­—ç¬¦åç§»é‡çš„ä½ç½®
                        stringKeyFloat = 65536 / stringKey, stringKeyIndex;
                    // è·å–è§£å¯†æ± 
                    while (string.length - subStart > desubIndex) {
                        decryptPool.push(string.substr(subStart, desubIndex));
                        subStart += desubIndex;
                        if (decryptPool.length === NullCount) {
                            desubIndex--;
                        }
                    }
                    decryptPool.push(string.substring(subStart));
                    // å¯¹è§£å¯†æ± è¿›è¡Œè§£å¯† å¹¶å°†è§£å¯†ç»“æœ åŠ å…¥åˆ° result(ç»“æœ) ä¸­
                    for (let j = decryptPool[0].length - 1, i; j > -1; j--) {
                        // ä¸ºèŠ‚çœNullCountçš„ç©ºé—´åˆ©ç”¨ï¼Œä½¿ç”¨NullCountç”¨æ¥è¾…åŠ©è®¡ç®— stringKeyIndex(åŠ å¯†å­—ç¬¦åç§»é‡çš„ä½ç½®) çš„ä½ç½®
                        // ç”»å›¾æ’åˆ—å°±çŸ¥é“ä¸ºä»€ä¹ˆè¦è¿™æ ·åšäº†ï¼Œä¸Šé¢åšäº†ä¸€ä¸ªåŠ å¯†åˆ°è§£å¯†çš„æ’åˆ—çš„è‰å›¾
                        NullCount = 0;
                        for (i = 0; i < decryptPool.length; i++) {
                            let char = decryptPool[i][j];
                            if (char) {
                                NullCount += decryptPool[i].length;
                                // è®¡ç®—å¾—åˆ°å½“å‰å­—ç¬¦çš„ä½ç½®
                                stringKeyIndex = NullCount - decryptPool[i].length + j + 1;
                                // è®¡ç®—å¾—åˆ° stringKeyIndex(åŠ å¯†å­—ç¬¦åç§»é‡çš„ä½ç½®) çš„ä½ç½®
                                stringKeyIndex = (stringKey - stringKeyIndex % stringKey) % stringKey;
                                // è®©åŠ å¯†åçš„åç§»é‡ï¼Œåç§»å›å»ï¼Œå¾—åˆ°åŸå…ˆçš„å­—ç¬¦ä¸²
                                result += String.fromCharCode((char.charCodeAt() - parseInt(stringKeyFloat * (stringKeyIndex % 2 === 0 ? stringKeyIndex : stringKey - stringKeyIndex)) + 65536) % 65536);
                            }
                        }
                    }
                    // è¿”å›è§£å¯†ç»“æœ
                    return result;
                } else {
                    // å¦‚æœè§£å¯†å­—ç¬¦ä¸²ä¸å­˜åœ¨å°±è¿”å›ç©ºå­—ç¬¦ä¸²
                    return "";
                }
            }

            // encrypt æ—¢å¯ä»¥ç”¨ä½œåŠ å¯† ä¹Ÿå¯ä»¥ç”¨ä½œè§£å¯†ï¼Œdecrypt æ—¢å¯ä»¥ç”¨ä½œè§£å¯† ä¹Ÿå¯ä»¥ç”¨ä½œåŠ å¯†ã€‚

            static ENCRYPT() {
                if (arguments) {
                    let strings = [], keys = [];
                    for (let i = 0; i < arguments.length; i++) {
                        // JavaScriptå¦‚ä½•ç”¨æœ€ç®€å•çš„æ–¹æ³•è·å–ä»»æ„å¯¹è±¡çš„ç±»åï¼Ÿ(åŒ…æ‹¬è‡ªå®šä¹‰ç±») åˆ¤æ–­å¯¹è±¡ç±»å‹ï¼Ÿ
                        // æ¬¢è¿æ”¯æŒæˆ‘çš„åŸåˆ›æ–‡æ¡£ https://blog.csdn.net/qq_37759464/article/details/121764755
                        if (arguments[i].constructor.name === "key") {
                            keys.push(arguments[i]);
                        } else if (arguments[i].constructor.name === "String") {
                            strings.push(arguments[i]);
                        }
                    }
                    if (strings) {
                        if (keys) {
                            for (let i = 0, j; i < strings.length; i++) {
                                for (j = 0; j < keys.length; j++) {
                                    strings[i] = i % 2 === 0 ? keys[j].encrypt(strings[i]) : keys[j].decrypt(strings[i]);
                                }
                            }
                            return strings.length === 1 ? strings[0] : strings;
                        } else {
                            if (!this[randomkey]) {
                                this[randomkey] = new key(parseInt(Math.random() * 1024) + 3);
                            }
                            // ä¸ºäº†ä½¿åŠ å¯†æ–¹æ³•ä¸ä¸€æ ·ï¼Œè¿™é‡Œåè¿‡æ¥
                            strings[i] = this[randomkey].decrypt(this[randomkey].decrypt(strings[i]));
                            return strings.length === 1 ? strings[0] : strings;
                        }
                    }
                }
            }

            static DECRYPT() {
                if (arguments) {
                    let strings = [], keys = [];
                    for (let i = 0; i < arguments.length; i++) {
                        if (arguments[i].constructor.name === "key") {
                            keys.push(arguments[i]);
                        } else if (arguments[i].constructor.name === "String") {
                            strings.push(arguments[i]);
                        }
                    }
                    if (strings) {
                        if (keys) {
                            for (let i = 0, j; i < strings.length; i++) {
                                for (j = keys.length - 1; j > -1; j--) {
                                    strings[i] = i % 2 === 0 ? keys[j].decrypt(strings[i]) : keys[j].encrypt(strings[i]);
                                }
                            }
                            return strings.length === 1 ? strings[0] : strings;
                        } else {
                            if (!this[randomkey]) {
                                this[randomkey] = new key(parseInt(Math.random() * 1024) + 3);
                            }
                            strings[i] = this[randomkey].encrypt(this[randomkey].encrypt(strings[i]));
                            return strings.length === 1 ? strings[0] : strings;
                        }
                    }
                }
            }
        }

        return key;
    })();

// æœ‰äººåé¦ˆè‹¹æœç«¯ä¸èƒ½çœ‹ï¼Œå°è¯•ä¿®æ”¹UAè§£å†³
    if (navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/iPod/i)) {
        // ä¿®æ”¹æ‰‹æœºç«¯UAï¼Œä¼¼ä¹æ”¹å®Œè¿™ä¸ªUAè¿˜æ˜¯æ²¡æœ‰æ•ˆæœã€‚è¯´æ˜è‹¹æœç«¯é¡µé¢ä»æ•°æ®è¯·æ±‚å°±å¼€å§‹æ£€æµ‹UAäº†ã€‚è¯·æ‰‹åŠ¨ä¿®æ”¹æµè§ˆå™¨UAã€‚
        Object.defineProperty(navigator, 'userAgent', {
            // è¿™ä¸ªUAä¼šå±è”½ç™¾åº¦æœç´¢çš„å¹¿å‘Šï¼Ÿ
            value: "Mozilla/5.0 (Linux; Android 8.0; MI 6 Build/OPR1.170623.027; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/48.0.2564.116 Mobile Safari/537.36 T7/10.3 SearchCraft/2.6.3 (Baidu; P1 8.0.0)",
            writable: false
        });
    }

    let settings = {};
    const root = document.querySelector(":root");
// æ ¸å¿ƒé©±åŠ¨ä»£ç 
    (() => {
        if (location.search.match(/[?&]url=https?:\/\/.+\..+\..+\/.+/i) ||
            location.search.match(/[?&]v=https?:\/\/.+\..+\..+\/.+/i) ||
            location.href.match(/https?:\/\/api\.leduotv\.com\/.+?vid=/i)) {
            settings.isParse = true;
        }
        if (settings.isParse || location.host.indexOf("v.qq.com") !== -1 || location.host.indexOf("iqiyi.com") !== -1 || location.host.indexOf("youku.com") !== -1 || location.host.indexOf("bilibili.com") !== -1 || location.host.indexOf("miguvideo.com") !== -1 || location.host.indexOf("le.com") !== -1 || location.host.indexOf("tv.sohu.com") !== -1 || location.host.indexOf("film.sohu.com") !== -1 || location.host.indexOf("mgtv.com") !== -1 || location.host.indexOf("ixigua.com") !== -1 || location.host.indexOf("pptv.com") !== -1 || location.host.indexOf("vip.1905.com") !== -1 || location.host.indexOf("www.wasu.com") !== -1) {
            // å¯¹ç¬¦åˆæ¡ä»¶çš„åŸŸåæ‰§è¡Œè„šæœ¬
            // è°ƒç”¨è‡ªå†™åŠ å¯†ç®—æ³•ï¼Œç”Ÿæˆå®ä¾‹ç±»
            settings.k1 = new key("Tenfond");
            settings.k2 = new key(" è…¾ é£ ");
            if (window === top) {
                settings.parseDB = {
                    è§£æå¼€å…³: "\x01", å¼¹å¹•å¼€å…³: "\x01", DIYè§£ææ : "\x01"
                };
                for (let name in settings.parseDB) {
                    let data = localStorage.getItem("è§£ææ•°æ®åº“." + name);
                    if (data !== null) {
                        settings.parseDB[name] = data;
                    }
                }
                // æ²¹çŒ´å¯ä»¥å®ç°è·¨åŸŸå­˜å‚¨
                try {
                    let data = GM_getValue("å¼¹å¹•å¼€å…³");
                    if (data !== null) settings.parseDB.å¼¹å¹•å¼€å…³ = data;
                } catch (e) {
                    // æ’é™¤æ— æ•ˆå‡½æ•°å¼‚å¸¸
                }

                if (settings.parseDB.è§£æå¼€å…³) {
                    if (!sessionStorage.getItem("tipè®¾ç½®")) {
                        showTip("å³ä¸‹è§’å¯ä»¥ç¼–è¾‘ è®¾ç½®");
                        sessionStorage.setItem("tipè®¾ç½®", "\x01");
                    }
                    readSettings();
                }
                settings.parseDBFuntions = {
                    è§£æå¼€å…³: () => {
                        if (!settings.parseDB.è§£æå¼€å…³) {
                            location.reload();
                            // window åˆ·æ–°æ—¶ä¼šè‡ªåŠ¨æ¸…é™¤ç¼“å­˜
                        } else {
                            readSettings();
                            settings.parseDB.è§£æå¼€å…³ = "\x01";
                        }
                    },
                    å¼¹å¹•å¼€å…³: () => {
                        try {
                            GM_setValue("å¼¹å¹•å¼€å…³", settings.parseDB.å¼¹å¹•å¼€å…³)
                        } catch (error) {
                            // æ’é™¤æ— æ•ˆå‡½æ•°å¼‚å¸¸
                        }
                        showTip("åˆ·æ–°é¡µé¢å³å¯ç”Ÿæ•ˆ");
                    },
                    DIYè§£ææ : () => {
                        if (typeof settings.DIY_iframeFunction === "function") {
                            settings.DIY_iframeFunction();
                        } else {
                            showTip("è®¾ç½®å·²ç”Ÿæ•ˆ");
                        }
                    }
                };
                let toolsBar = document.createElement("toolsbar");
                toolsBar.style = "display: block !important; visibility: visible !important; position: fixed; z-index: 2147483647 !important; left:0; bottom: 0; width: 100%; height: 0; font-family: å¾®è½¯é›…é»‘,é»‘ä½“,Droid Serif,Arial,sans-serif; font-size: 15px; color: #000;";
                toolsBar.innerHTML = "<style>\n" +
                    "    text{font-family: å¾®è½¯é›…é»‘,é»‘ä½“,Droid Serif,Arial,sans-serif; font-size: 15px; color: #000; position: absolute; transform: translateY(-50%); top: 50%;}\n" +
                    "    label.parse-switch{position: absolute; transform: translateY(-50%); top: 50%; display: inline-block; width: 44px; height: 24px; box-shadow: 0 0 0 1px #ccc; border-radius: 30px; overflow: hidden;}\n" +
                    "    label.parse-switch>input[type=checkbox]{display: none;}\n" +
                    "    label.parse-switch>input[type=checkbox]+bg{position: absolute; transition: background-color 0.3s; background-color: #ccc; width: 100%; height: 100%;}\n" +
                    "    label.parse-switch>input[type=checkbox]:checked+bg{background-color: #4af}\n" +
                    "    label.parse-switch>input[type=checkbox]+bg+span{position: absolute; transition: left 0.3s; left: 0; width: 24px; height: 24px; border-radius: 50%; background-color: #fff;}\n" +
                    "    label.parse-switch>input[type=checkbox]:checked+bg+span{left: 20px}\n" + "\n" +
                    "    settings>button+ul>li{position: relative; background-color: #0000; width: 100%; height: 30px;}\n" +
                    "</style>\n" + "<settings style='box-shadow: 0 0 6px 2px #444; position: fixed; width: 50px; height: 30px; right: 7%; bottom: 45px; border-radius: 15px;'>" +
                    "    <button style='width: 100%; height: 100%; border-radius: 17px; background-color: #4af; border-color: #4af; text-align: center; color: #fff;'>\n" +
                    "        è®¾ç½®\n" +
                    "    </button>\n" +
                    "    <ul style='position:absolute; transition: all 0.5s; right: 7%; bottom: 100%; opacity: 0; width: 0; height: auto; background-color: #fffc; border: 1px solid #ccc; border-radius: 5px;'>\n" +
                    "    </ul>\n" +
                    "</settings>";
                let SettingsBlock = toolsBar.querySelector("settings>button+ul");
                let parseDBKeys = Object.keys(settings.parseDB);
                for (let i = 0; i < parseDBKeys.length; i++) {
                    SettingsBlock.innerHTML += "<li><text style='left: 10px'>" + parseDBKeys[i] + "</text><label class='parse-switch' style='right: 10px;'><input type='checkbox'><bg></bg><span></span></label></li>\n";
                }
                let SettingBlockSwitchs = SettingsBlock.querySelectorAll("li>label.parse-switch");
                for (let i = 0; i < SettingBlockSwitchs.length; i++) {
                    let checkBox = SettingBlockSwitchs[i].querySelector("input[type=checkbox]");
                    checkBox.checked = Boolean(settings.parseDB[parseDBKeys[i]]);
                    SettingBlockSwitchs[i].querySelector("bg").addEventListener("transitionend", () => {
                        if (checkBox.checked !== Boolean(settings.parseDB[parseDBKeys[i]])) {
                            // å¦‚æœæœ‰å˜åŒ–æ‰ä¼šæ‰§è¡Œï¼Œå¦åˆ™ä¼šé‡å¤æ‰§è¡Œï¼Œå› ä¸ºåŠ¨ç”»ä¼šæœ‰å»¶è¿Ÿï¼Œåˆšæ‰“å¼€ç½‘é¡µæ—¶ä¹Ÿä¼šè§¦å‘æ­¤ç›‘å¬äº‹ä»¶
                            if (checkBox.checked) {
                                settings.parseDB[parseDBKeys[i]] = "\x01";
                            } else {
                                settings.parseDB[parseDBKeys[i]] = "";
                            }
                            localStorage.setItem("è§£ææ•°æ®åº“." + parseDBKeys[i], settings.parseDB[parseDBKeys[i]]);
                            settings.parseDBFuntions[parseDBKeys[i]]();
                        }
                    }, false);
                }
                let SettingsBtn = toolsBar.querySelector("settings>button");
                SettingsBtn.onclick = () => {
                    if (SettingsBlock.style.opacity === "0") {
                        SettingsBtn.innerText = "å…³é—­";
                        SettingsBlock.style.opacity = "1";
                        SettingsBlock.style.width = "200px";
                    } else {
                        SettingsBtn.innerText = "è®¾ç½®";
                        SettingsBlock.style.opacity = "0";
                        SettingsBlock.style.width = "0";
                    }
                }
                root.append(toolsBar);
            } else {
                readSettings();
            }
        }
    })();

// å¯åŠ¨è§£æä»£ç 
    function start() {
        console.log("è„šæœ¬è¿è¡Œåœ¨ " + location.href);

        function detectMobile() {
            return (navigator.userAgent.match(/Android/i) ||
                navigator.userAgent.match(/webOS/i) ||
                navigator.userAgent.match(/Windows Phone/i) ||
                navigator.userAgent.match(/Symbian/i) ||
                navigator.userAgent.match(/BlackBerry/i) ||
                navigator.userAgent.match(/hpwOS/i));
        }

        function doElement(cssString, doFunction, waitMS = 0) {
            let Element = document.querySelector(cssString);
            if (Element && Element.nodeType === 1) {
                doFunction(Element);
                console.log("%cå·²ä¸º " + cssString + " è¿›è¡Œäº†æ“ä½œ", settings.fontStyle.ok);
            } else if (document.readyState !== "complete" || waitMS > 0) {
                console.log("æ­£åœ¨æŸ¥æ‰¾ " + cssString);    // TODO                                                                10æ¯«ç§’çº¦å‡½æ•°æ‰§è¡Œæ—¶é—´
                setTimeout(() => doElement(cssString, doFunction, document.readyState !== "complete" ? waitMS : waitMS - 10 - settings.getElementTimes), settings.getElementTimes);
            } else {
                console.log("%cæœªæ‰¾åˆ° " + cssString, settings.fontStyle.error);
            }
        }

        function doElements(cssString, doFunction, waitMS = 0, index = 0) {
            let Elements = document.querySelectorAll(cssString);
            if (Elements[index] && Elements[index].nodeType === 1) {
                doFunction(Elements);
                console.log("%cå·²ä¸º All[" + index + "] " + cssString + " è¿›è¡Œäº†æ“ä½œ", settings.fontStyle.ok);
            } else if (document.readyState !== "complete" || waitMS > 0) {
                console.log("æ­£åœ¨æŸ¥æ‰¾ All[" + index + "] " + cssString);    // TODO                                             10æ¯«ç§’çº¦å‡½æ•°æ‰§è¡Œæ—¶é—´
                setTimeout(() => doElements(cssString, doFunction, document.readyState !== "complete" ? waitMS : waitMS - 10 - settings.getElementTimes, index), settings.getElementTimes);
            } else {
                console.log("%cæœªæ‰¾åˆ° All[" + index + "] " + cssString, settings.fontStyle.error);
            }
        }

        function forElements(cssString, doFunction, waitMS = 0, failFunction = null) {
            let forElementInterval = setInterval(() => {
                if (document.readyState !== "complete" || waitMS > 0) {
                    let Elements = document.querySelectorAll(cssString);
                    if (Elements && Elements.length > 0 && Elements[0].nodeType === 1) {
                        doFunction(Elements, forElementInterval);
                        console.log("%cforElementså·²ä¸º " + cssString + " è¿›è¡Œäº†æ“ä½œ", settings.fontStyle.ok);
                    }
                    if (document.readyState === "complete") {
                        waitMS = waitMS - 10 - settings.getElementTimes;
                    }
                } else {
                    if (failFunction) {
                        failFunction();
                    }
                    console.log("å·²æ¸…é™¤ forElements Intervalè®¡æ—¶å™¨")
                    clearInterval(forElementInterval);
                }
            }, settings.getElementTimes);
        }

        function removeElements(ElementsStrings) {
            console.log("æ­£åœ¨æ£€æµ‹å¹¶ç§»é™¤ " + ElementsStrings);
            let removeElementsInterval = setInterval(() => {
                if (ElementsStrings.length > 0) {
                    for (let i in ElementsStrings) {
                        try {
                            let Elements = eval(ElementsStrings[i]);
                            if (Elements && Elements.nodeType === 1) {
                                console.log("%cremoveElemets æ‰§è¡Œäº†ç§»é™¤ " + ElementsStrings[i], settings.fontStyle.ok);
                                Elements.parentNode.removeChild(Elements);
                                ElementsStrings.splice(i, 1);
                            } else if (Elements[0] && Elements[0].nodeType === 1) {
                                console.log("%cremoveElemets æ‰§è¡Œäº†ç§»é™¤ " + ElementsStrings[i], settings.fontStyle.ok);
                                for (let Element of Elements) {
                                    Element.parentNode.removeChild(Element);
                                }
                                ElementsStrings.splice(i, 1);
                            }
                        } catch (e) {
                            // æ’é™¤ nullå€¼æœªæ‰¾åˆ°æ–¹æ³• é”™è¯¯
                        }
                    }
                    if (document.readyState === "complete") {
                        console.log("%cremoveElemets ç§»é™¤å¤±è´¥ " + ElementsStrings, settings.fontStyle.error);
                        clearInterval(removeElementsInterval);
                    }
                } else {
                    clearInterval(removeElementsInterval);
                    console.log("Elements ç§»é™¤å®Œæ¯•");
                }
            }, 200);
        }

        if (window === top) {
            // è‡ªå®šä¹‰removeæ–¹æ³•ï¼Œæš‚æ—¶ç”¨ä¸ç€äº†ï¼Œæ–°æ–¹æ¡ˆä»£æ›¿äº†
            // Array.prototype.remove = value => {
            //     for (let i = 0; i < this.length; i++) {
            //         if (this[i] === value) {
            //             this.splice(i, 1);
            //             return i;
            //         }
            //     }
            //     return -1;
            // }
            top.addEventListener("message", event => {
                if (event.source !== window) {
                    try {
                        let sql = key.DECRYPT(event.data, settings.k1, settings.k2).split("\x00");
                        if (sql[0] === "å®å¡”é•‡æ²³å¦–") {
                            if (sql[1] === "å‡½æ•°") {
                                console.log("topæ‰§è¡Œäº†å‡½æ•°: " + sql[2]);
                                eval(sql[2]);
                            } else if (sql[1] === "è¯·æ±‚") {
                                if (sql[2] === "ç”¨æˆ·æ•°æ®åº“") {
                                    event.source.postMessage(key.ENCRYPT("å¤©ç‹ç›–åœ°è™\x00ç»™äºˆ\x00ç”¨æˆ·æ•°æ®åº“\x00" + JSON.stringify(settings.parseDB), settings.k1, settings.k2), "*");
                                }
                            } else if (sql[1] === "ç»™äºˆ") {
                                if (sql[2] === "0") {
                                    if (settings.address !== null) {
                                        settings.address = sql[3];
                                    }
                                    console.log("%c" + settings.address, settings.fontStyle.warn);
                                } else if (sql[2] === "-1") {
                                    if (settings.address === sql[3]) {
                                        showTip("è§£æå¤±è´¥ï¼Œæ­£åœ¨æ›´æ¢è§£ææº");
                                        settings.randomSeleceParse();
                                    }
                                }
                            } else if (sql[1] === "æŒ‰ä¸‹Enterè·å–ç„¦ç‚¹") {
                                onkeydown = e => {
                                    if (e.key === 'Enter') {
                                        event.source.focus();
                                    }
                                }
                            }
                        }
                    } catch (e) {
                        console.log("%c" + e, settings.fontStyle.error);
                    }
                }
            });

            if (!detectMobile()) {
                if (location.host.indexOf("v.qq.com") !== -1) {
                    readyPlayerBox("å·²è¿›å…¥è…¾è®¯è§†é¢‘", ["#mask_layer", ".mod_vip_popup", "#mask_layer", "div.panel-overlay.panel-tip-pay", "div.thumbplayer-barrage"], [settings.NoADè§£æ["OKè§£æ"], settings.NoADè§£æ["TVè§£æ"], settings.NoADè§£æ["å¤©ç¿¼è§£æ"], settings.NoADè§£æ["è¯ºè®¯è§£æ"]], "div#player", null);
                } else if (location.host.indexOf("iqiyi.com") !== -1) {
                    doElement("div.side-cont.tvg", () => readyPlayerBox("å·²è¿›å…¥çˆ±å¥‡è‰º", ["#playerPopup", "div[class^=qy-header-login-pop]"], [settings.NoADè§£æ["OKè§£æ"]], "iqpdiv.iqp-player[data-player-hook$=er]", null));
                } else if (location.host.indexOf("youku.com") !== -1) {
                    readyPlayerBox("å·²è¿›å…¥ä¼˜é…·è§†é¢‘", ["#iframaWrapper"], [], "div#player", null);
                } else if (location.host.indexOf("bilibili.com") !== -1) {
                    doElements("div[role=tooltip]:not([class*=popover-])", loginTip => displayNone(["#" + loginTip[6].id]), 1000, 6);
                    doElement("svg[aria-hidden=true]", () => readyPlayerBox("å·²è¿›å…¥å“”å“©å“”å“©", null, [settings.NoADè§£æ["å¤œå¹•è§£æ"], settings.NoADè§£æ["å¤©ç¿¼è§£æ"]], "div.bpx-player-video-area,div.mask-container", null));    // TODO || document.getElementById("bilibiliPlayer") || document.getElementById("live-player-ctnr")
                } else if (location.host.indexOf("miguvideo.com") !== -1) {
                    readyPlayerBox("å·²è¿›å…¥å’ªå’•è§†é¢‘", null, [], "section#mod-player", null);
                } else if (location.host.indexOf("le.com") !== -1) {
                    readyPlayerBox("å·²è¿›å…¥ä¹è§†TV", null, [settings.NoADè§£æ["äº‘è§£æ"]], "#le_playbox", null);
                } else if (location.host.match(/(tv|film).sohu.com/)) {
                    readyPlayerBox("å·²è¿›å…¥æœç‹è§†é¢‘", null, [settings.NoADè§£æ["å¤œå¹•è§£æ"]], "#player,#sohuplayer,.player-view", null);
                } else if (location.host.indexOf("mgtv.com") !== -1) {
                    readyPlayerBox("å·²è¿›å…¥èŠ’æœTV", null, [settings.NoADè§£æ["çˆ±è§£æ"], settings.NoADè§£æ["OKè§£æ"], settings.NoADè§£æ["äº‘è§£æ"], settings.NoADè§£æ["è™¾ç±³è§£æ"], settings.NoADè§£æ["å¤œå¹•è§£æ"]], "#mgtv-player-wrap", null);
                } else if (location.host.indexOf("ixigua.com") !== -1) {
                    readyPlayerBox("å·²è¿›å…¥è¥¿ç“œè§†é¢‘", null, [settings.NoADè§£æ["å¤œå¹•è§£æ"]], "div.teleplayPage__playerSection", null);
                } else if (location.host.indexOf("pptv.com") !== -1) {
                    readyPlayerBox("å·²è¿›å…¥PPTV", null, [settings.NoADè§£æ["OKè§£æ"]], "div.w-video", null);
                } else if (location.host.indexOf("vip.1905.com") !== -1) {
                    readyPlayerBox("å·²è¿›å…¥1905ç”µå½±ç½‘", null, [settings.NoADè§£æ["äº‘è§£æ"]], "div#playBox", null);
                } else if (location.host.indexOf("www.wasu.cn") !== -1) {
                    readyPlayerBox("å·²è¿›å…¥åæ•°TV", null, [settings.NoADè§£æ["OKè§£æ"]], "div#pcplayer", null);
                }
            } else {
                if (location.host.indexOf("v.qq.com") !== -1) {
                    readyPlayerBox("å·²è¿›å…¥è…¾è®¯è§†é¢‘", [".mod_vip_popup", "[class^=app_],[class^=app-],[class*=_app_],[class*=-app-],[class$=_app],[class$=-app]", "div[dt-eid=open_app_bottom]", "div.video_function.video_function_new", "a[open-app]", "section.mod_source", "section.mod_box.mod_sideslip_h.mod_multi_figures_h,section.mod_sideslip_privileges,section.mod_game_rec"], [settings.NoADè§£æ["OKè§£æ"]], "div.mod_play:not([style*='display: none;']) section.mod_player", null, href => {
                        let location = hrefToLocation(href);
                        href = searchToJSON(location.search);
                        if (href) {
                            if (href["cid"]) {
                                if (href["id"]) {
                                    return location.protocol + '//v.qq.com/detail/' + href["cid"][0] + '/' + href["cid"] + '.html';
                                } else if (href["vid"]) {
                                    return location.protocol + '//v.qq.com/x/cover/' + href["cid"] + '/' + href["vid"] + '.html';
                                } else {
                                    return location.protocol + '//v.qq.com/x/cover/' + href["cid"] + '.html';
                                }
                            } else if (href["vid"]) {
                                return location.protocol + '//v.qq.com/x/page/' + href["vid"] + '.html';
                            } else if (href["lid"]) {
                                return location.protocol + '//v.qq.com/detail/' + href["lid"][0] + '/' + href["lid"] + '.html';
                            } else {
                                return null;
                            }
                        } else {
                            return null;
                        }
                    });
                } else if (location.host.indexOf("iqiyi.com") !== -1) {
                    readyPlayerBox("å·²è¿›å…¥çˆ±å¥‡è‰º", ["div.m-iqyGuide-layer", "a[down-app-android-url]", "[name=m-extendBar]", "[class*=ChannelHomeBanner]", "section.m-hotWords-bottom"], [settings.NoADè§£æ["OKè§£æ"]], "div.m-video-player-wrap", null);
                } else if (location.host.indexOf("youku.com") !== -1) {
                    readyPlayerBox("å·²è¿›å…¥ä¼˜é…·è§†é¢‘", ["#iframaWrapper", ".ad-banner-wrapper", ".h5-detail-guide,.h5-detail-vip-guide,[class$=ad],.Corner-container", "[data-spm='downloadApp'],.downloadApp", ".callEnd_box"], [], "#player", null);
                } else if (location.host.indexOf("bilibili.com") !== -1) {
                    readyPlayerBox("å·²è¿›å…¥å“”å“©å“”å“©", ["div.fe-ui-open-app-btn,div.recom-wrapper,open-app-btn", "[class*=openapp]"], [settings.NoADè§£æ["å¤œå¹•è§£æ"], settings.NoADè§£æ["å¤©ç¿¼è§£æ"]], "div#app.main-container div.player-wrapper", null, href => href.replace("m.bilibili.com", "www.bilibili.com"));
                } else if (location.host.indexOf("miguvideo.com") !== -1) {
                    readyPlayerBox("å·²è¿›å…¥å’ªå’•è§†é¢‘", ["[class^=app_],[class^=app-],[class*=_app_],[class*=-app-],[class$=_app],[class$=-app]", ".openClient", "div.group-item.programgroup .data-rate-01,div.group-item.programgroup .max-rate-01,div.group-item.programgroup .p-common"], [], "section#mod-player", null, href => href.replace("m.miguvideo.com", "www.miguvideo.com").replace("msite", "website"));
                } else if (location.host.indexOf("le.com") !== -1) {
                    (block_show => {
                        block_show.innerHTML = "div.layout{visibility: visible !important; display:block !important;}div.layout>*:not(style,script,#j-vote,#j-follow){visibility: visible !important; display: block !important;}";
                        document.head.insertBefore(block_show, document.head.firstChild);
                    })(document.createElement("style"));
                    doElement("a.j-close-gdt", jump_over => {
                        jump_over.click();
                        return false;
                    });
                    readyPlayerBox("å·²è¿›å…¥ä¹è§†TV", ["a.leapp_btn", "div.full_gdt_bits[id^=full][data-url]", "[class*=Daoliu],[class*=daoliu],[class*=game]", "div.m-start", "[class*=icon_user]"], [settings.NoADè§£æ["äº‘è§£æ"]], "div.column.play", null);
                } else if (location.host.indexOf("m.tv.sohu.com") !== -1) {
                    readyPlayerBox("å·²è¿›å…¥æœç‹è§†é¢‘", ["div[class^=banner]", "div.js-oper-pos", "div[id^=ad],div[id^=ad] *", "[id*=login],[class*=login]", "[class$=-app]", "div.app-vbox.ph-vbox,div.app-vbox.app-guess-vbox", "div.twinfo_iconwrap", "div[class$=banner],div[id$=banner]"], [settings.NoADè§£æ["å¤œå¹•è§£æ"]], "#player,#sohuplayer,.player-view", null, async href => {
                        return new Promise(resolve => {
                            xmlHttpRequest({
                                url: href, success: data => {
                                    let result = data.responseText.match(/var videoData = \{[^\x00]+tvUrl:"(http.+)",[\r\n]/)[1];
                                    resolve(result);
                                }, error: () => resolve(href)
                            });
                        });
                    });
                } else if (location.host.indexOf("mgtv.com") !== -1) {
                    readyPlayerBox("å·²è¿›å…¥èŠ’æœTV", ["div.adFixedContain,div.ad-banner,div.m-list-graphicxcy.fstp-mark", "div[class^=mg-app],div#comment-id.video-comment div.ft,div.bd.clearfix,div.v-follower-info", "div.ht.mgui-btn.mgui-btn-nowelt", "div.personal", "div[data-v-41c9a64e]"], [settings.NoADè§£æ["çˆ±è§£æ"], settings.NoADè§£æ["OKè§£æ"], settings.NoADè§£æ["äº‘è§£æ"], settings.NoADè§£æ["è™¾ç±³è§£æ"], settings.NoADè§£æ["å¤œå¹•è§£æ"]], "div.video-poster,div.video-area", null);
                } else if (location.host.indexOf("ixigua.com") !== -1) {
                    readyPlayerBox("å·²è¿›å…¥è¥¿ç“œè§†é¢‘", ["div.xigua-download", "div.xigua-guide-button", "div.c-long-video-recommend.c-long-video-recommend-unfold"], [settings.NoADè§£æ["å¤œå¹•è§£æ"]], "div.xigua-detailvideo-video", null);
                } else if (location.host.indexOf("pptv.com") !== -1) {
                    readyPlayerBox("å·²è¿›å…¥PPTV", ["[data-darkreader-inline-bgimage][data-darkreader-inline-bgcolor]", "div[class^=pp-m-diversion]", "section#ppmob-detail-picswiper", "section.layout.layout_ads", "div.foot_app", "div[modulename=å¯¼æµä½]", "a[class*=user]", "div.mod_video_info div.video_func"], [settings.NoADè§£æ["OKè§£æ"]], "section.pp-details-video", null, href => href.replace("m.pptv.com", "v.pptv.com"));
                } else if (location.host.indexOf("vip.1905.com") !== -1) {
                    (movie_info => {
                        movie_info.innerHTML = "section#movie_info{padding-top: 20px !important;}";
                        document.head.appendChild(movie_info);
                    })(document.createElement("style"));
                    readyPlayerBox("å·²è¿›å…¥1905ç”µå½±ç½‘", ["a.new_downLoad[target=_blank]", "iframe[srcdoc^='<img src=']", "section.movieList_new.club_new", ".wakeAppBtn", "[class*=login]", "section.openMembershipBtn", ".ad", ".open-app,.openApp,ul.iconList li:not(.introduceWrap),div#zhichiBtnBox", "section#hot_movie,section#exclusive_movie,section#hot_telve"], [settings.NoADè§£æ["äº‘è§£æ"]], "div.area.areaShow.clearfix_smile", null);
                } else if (location.host.indexOf("www.wasu.cn") !== -1) {
                    readyPlayerBox("å·²è¿›å…¥åæ•°TV", ["div.ws_poster", "div.appdown,div.player_menu_con", "div#play_and_info_fix_adv"], [settings.NoADè§£æ["OKè§£æ"]], "div#player,div#pop", null);
                }
            }

            function readyPlayerBox(Tip, displayNones, srcs, cssString, doFunction, doHref = null) {
                if (Tip) {
                    console.log("%c" + Tip, settings.fontStyle.maxTip);
                }
                onLocationChange(() => location.reload());    // TODO ,ç›‘å¬urlå˜åŒ–,å¦‚æœç½‘é¡µrulå˜äº†å°±åˆ·æ–°é¡µé¢

                if (displayNones) {
                    displayNone(displayNones);
                }
                doElement(cssString, async playerBox => {
                    setInterval(() => {
                        for (let link of document.querySelectorAll("a")) {
                            link.onclick = () => {
                                if (link.host === location.host) {
                                    location.href = link.href;
                                }
                            }
                        }
                    }, 1500);

                    let iframe = document.createElement("iframe");
                    iframe.allowFullscreen = true;
                    iframe.frameBorder = "0";   // HTML5å·²å¼ƒç”¨æ­¤å±æ€§ï¼Œå¹¶ä½¿ç”¨style.borderä»£æ›¿
                    iframe.width = "100%";
                    iframe.height = "100%";
                    let iframe_style = "background-color: #000 !important; border: 0 !important; display: block !important; visibility: visible !important; opacity: 1 !important; min-width: 100% !important; width: 100% !important; max-width: 100% !important; min-height: 100% !important; height: 100% !important; max-height: 100% !important; position: absolute !important; left: 0px !important; top: 0px !important; z-index: 2147483647 !important; overflow: hidden;";
                    iframe.style = iframe_style;

                    let iframeStartTime, tested = false, others = Object.values(settings.NoADè§£æ).filter(value => {
                        // æ±‚å‡º srcs åœ¨ NoADè§£æ ä¸­çš„è¡¥é›†
                        return srcs.indexOf(value) === -1;
                    });
                    settings.src = (() => {
                        const src = Symbol();

                        class Src {
                            static async set(key, value = location.href) {
                                if (!key) return false;
                                this[src] = key;
                                if (typeof doHref === "function") {
                                    let href = await doHref(value);
                                    iframe.src = key ? key + (href ? href : value) : "";
                                } else {
                                    iframe.src = key ? key + value : "";
                                }
                                iframeStartTime = new Date().getTime();
                                return true;
                            }

                            static get() {
                                return this[src];
                            }
                        }

                        return Src;
                    })();
                    settings.randomSeleceParse = async () => {
                        // arguments ä»£è¡¨è¾“å…¥çš„æ‰€æœ‰å‚æ•°ï¼Œçœ‹ä¸æ‡‚å¯ä»¥ç™¾åº¦æœç´¢ â€œjs å‚æ•° argumentsâ€
                        // return arguments ? arguments[Math.floor(Math.random() * arguments.length)] : null;
                        if (srcs.length > 0) {
                            let random = Math.floor(Math.random() * srcs.length);
                            settings.src.set(srcs[random]);
                            srcs.splice(random, 1);
                        } else {
                            if (tested) {
                                showTip("è¯¥è§†é¢‘å¯èƒ½æ— æ³•è§£æ\nè¯·å°è¯•ä½¿ç”¨z1è§£æ\nå¦‚æœ‰ç–‘é—®è¯·åé¦ˆ");
                                return false;
                            } else {
                                showTip("è§£æå¤±è´¥ï¼Œæ­£åœ¨å°è¯•å…¶ä»–è§£ææº");
                                srcs = others;
                                others = null;
                                tested = true;
                                let random = Math.floor(Math.random() * srcs.length);
                                settings.src.set(srcs[random]);
                                srcs.splice(random, 1);
                            }
                        }

                    }

                    // è·å–å†å²è§£æ
                    settings.src.set(localStorage.getItem("historyParse"));
                    if (!settings.src.get()) {
                        await settings.randomSeleceParse();
                    } else {
                        // æ¸…é™¤å¤šä½™çš„ä¸€ä¸ªè§£æapi
                        srcs.splice(srcs.indexOf(settings.src.get()), 1);
                    }
                    playerBox.style.zIndex = "1";
                    iframe.onload = () => {
                        // åˆ¤æ–­iframeåŠ è½½å®Œæˆçš„æ—¶é—´
                        if (new Date().getTime() - iframeStartTime < 500) {
                            // å¦‚æœåŠ è½½æ—¶é—´å°äºåŠç§’ï¼Œå¹¶ä¸”æ£€æµ‹ç½‘é¡µåŠ è½½å‡ºé”™ï¼Œè¯´æ˜ç½‘é¡µæœ‰é—®é¢˜ã€‚
                            xmlHttpRequest({
                                url: iframe.src,
                                error: () => {
                                    showTip("è¯¥è§£æå·²å¤±æ•ˆï¼Œå·²åˆ‡æ¢æ¨èè§£ææº");
                                    settings.randomSeleceParse();
                                }
                            })
                        }
                    }
                    playerBox.appendChild(iframe);
                    console.log(iframe);
                    console.log("%cplayerBoxå·²å»ºç«‹è§£æè¿æ¥", settings.fontStyle.maxTip);

                    let DIY_iframe;
                    settings.DIY_iframeFunction = () => {
                        if (settings.parseDB.DIYè§£ææ ) {
                            if (!DIY_iframe || DIY_iframe.constructor.name !== "HTMLDivElement") {
                                // è‡ªå®šä¹‰è§£æåœ°å€
                                DIY_iframe = document.createElement("div");
                                DIY_iframe.style = "display: flex; background-color: #0000; font-family: å¾®è½¯é›…é»‘,é»‘ä½“,Droid Serif,Arial,sans-serif; font-size: 15px;" + " position: fixed; height: 30px; width: 86%; transform: translateX(-50%); left: 50%; max-width: 600px; border-radius: 15px; box-shadow: 0 0 6px 2px #444; bottom: 5px;";
                                DIY_iframe.innerHTML = "<select style='border: 0; background-color: #ddd; text-align: center; min-width: 80px; width: 80px; height: 100%; border-bottom-left-radius: 15px; border-top-left-radius: 15px;'></select>" + "<input type='text' style='border: 0; background-color: #eee; padding-left: 10px; flex-grow: 1; width: 123px; height: 100%;' placeholder='(å½“å‰ç½‘å€è¯·ç•™ç©º)'>" + "<button style='background-color: #4af; border-color: #4af; text-align: center; color: #fff; min-width: 54px; width: 54px; height: 100%; border-bottom-right-radius: 15px; border-top-right-radius: 15px;'>è§£æ</button>";
                                let DIY_iframe_text = DIY_iframe.querySelector("input[type=text]");

                                async function DIY_iframe_src() {
                                    let newiframe = document.querySelector("iframe[id*=player]");
                                    if (newiframe) {
                                        iframe = newiframe;
                                    }
                                    settings.src.set(DIY_iframe_select.options[DIY_iframe_select.selectedIndex].value, DIY_iframe_text.value ? DIY_iframe_text.value : location.href);
                                    // é¢„å…ˆè®¾ç½®å†å²è§£ææºï¼ˆç”¨äºé€‚é…ä¸æ”¯æŒiframeæ‰§è¡Œè„šæœ¬çš„æµè§ˆå™¨ï¼‰
                                    localStorage.setItem('historyParse', settings.src.get());
                                }

                                let DIY_iframe_select = DIY_iframe.querySelector("select");
                                for (let name in settings.NoADè§£æ) {
                                    DIY_iframe_select.innerHTML += "<option value='" + settings.NoADè§£æ[name] + "' style='text-align: center'>" + name + "</option>";
                                }
                                for (let name in settings.ADè§£æ) {
                                    DIY_iframe_select.innerHTML += "<option value='" + settings.ADè§£æ[name] + "' style='text-align: center; color: #fa0; '>âš " + name + "</option>";
                                }
                                DIY_iframe.querySelector("option[value='" + settings.src.get() + "']").selected = true;
                                settings.randomSeleceParse = async () => {
                                    // arguments ä»£è¡¨è¾“å…¥çš„æ‰€æœ‰å‚æ•°ï¼Œçœ‹ä¸æ‡‚å¯ä»¥ç™¾åº¦æœç´¢ â€œjs å‚æ•° argumentsâ€
                                    // return arguments ? arguments[Math.floor(Math.random() * arguments.length)] : null;
                                    if (srcs.length > 0) {
                                        let random = Math.floor(Math.random() * srcs.length);
                                        settings.src.set(srcs[random]);
                                        srcs.splice(random, 1);
                                        DIY_iframe.querySelector("option[value='" + settings.src.get() + "']").selected = true;
                                    } else {
                                        if (tested) {
                                            showTip("è¯¥è§†é¢‘å¯èƒ½æ— æ³•è§£æ\nè¯·å°è¯•ä½¿ç”¨z1è§£æ\nå¦‚æœ‰ç–‘é—®è¯·åé¦ˆ");
                                            return false;
                                        } else {
                                            showTip("è§£æå¤±è´¥ï¼Œæ­£åœ¨å°è¯•å…¶ä»–è§£ææº");
                                            srcs = others;
                                            others = null;
                                            tested = true;
                                            let random = Math.floor(Math.random() * srcs.length);
                                            settings.src.set(srcs[random]);
                                            srcs.splice(random, 1);
                                        }
                                    }
                                    settings.address = {"0": 0, "-1": 1};
                                }
                                DIY_iframe.querySelector("button").onclick = () => DIY_iframe_src();
                                DIY_iframe_select.onchange = () => {
                                    DIY_iframe_src();
                                }
                                DIY_iframe_text.onkeydown = event => {
                                    if (event.key === "Enter") {
                                        DIY_iframe_src();
                                    }
                                }
                                doElement("toolsbar", toolsBar => {
                                    toolsBar.appendChild(DIY_iframe);
                                });
                            } else if (DIY_iframe.style.visibility === "hidden") {
                                DIY_iframe.style.display = "flex";
                                DIY_iframe.style.visibility = "";
                            }
                        } else if (DIY_iframe && DIY_iframe.constructor.name === "HTMLDivElement" && DIY_iframe.style.visibility === "") {
                            DIY_iframe.style.display = "none";
                            DIY_iframe.style.visibility = "hidden";
                        }
                    }
                    settings.DIY_iframeFunction();

                    (waiter => {
                        waiter /= settings.getElementTimes;
                        let resetPlayerBoxInterval = setInterval(() => {
                            let newPlayerBox = document.querySelector(cssString);
                            if (newPlayerBox !== playerBox && newPlayerBox !== null || newPlayerBox !== null && newPlayerBox.querySelector("iframe[src='" + iframe.src + "']") === null) {
                                console.log("playerBoxé‡æ–°å»ºç«‹è¿æ¥");
                                let src = iframe.src;
                                iframe.src = "";
                                iframe = iframe.cloneNode(true);
                                iframe.src = src;
                                newPlayerBox.style.zIndex = "1";
                                newPlayerBox.appendChild(iframe);
                                clearInterval(resetPlayerBoxInterval);
                            } else if (document.readyState === "complete" && waiter-- <= 0) {
                                clearInterval(resetPlayerBoxInterval);
                            }
                        }, settings.getElementTimes)
                    })(0);

                    if (doFunction) {
                        doFunction(playerBox, iframe);
                    }
                    setInterval(() => {
                        for (let video of document.getElementsByTagName("video")) {
                            if (video.src) {
                                video.removeAttribute("src");
                                video.load();
                                video.muted = true;
                            }
                        }

                        for (let other_iframe of document.querySelectorAll("iframe,fake-iframe-video")) {
                            if (other_iframe.src !== iframe.src || other_iframe.constructor.name !== iframe.constructor.name) {
                                other_iframe.parentNode.removeChild(other_iframe);
                            }
                        }
                        if (iframe.style !== iframe_style) {
                            iframe.style = iframe_style;
                        }
                    }, settings.getElementTimes);

                    ['fullscreenchange', 'webkitfullscreenchange', 'mozfullscreenchange'].forEach(item => {
                        window.addEventListener(item, () => {
                            let toolsBar = document.querySelector("toolsbar");
                            if (document.fullScreen || document.mozFullScreen || document.webkitIsFullScreen) {
                                toolsBar.style.display = 'none';
                            } else {
                                toolsBar.style.display = 'block';
                            }
                        }, true);
                    });
                });
            }

            function hrefToLocation(href) {
                let location = {href: href}, c = 0, start = 0, search;
                for (let i = 0, port; i < href.length; i++) {
                    if (href[i] === "/") {
                        if (++c === 1) {
                            location.protocol = href.substring(start, i);
                        } else if (c === 3) {
                            location.host = href.substring(start + 1, i);
                            if (port) {
                                location.port = href.substring(port + 1, i);
                            } else {
                                location.hostname = location.host;
                                location.port = "";
                            }
                        }
                        if (c <= 3) {
                            start = i;
                        }
                    } else if (href[i] === ":" && c === 2) {
                        location.hostname = href.substring(start + 1, i);
                        port = i;
                    } else if (href[i] === "?" && !search) {
                        location.pathname = href.substring(start, i);
                        search = i;
                    } else if (href[i] === "#" && !location.hash) {
                        location.hash = href.substr(i);
                        if (location.pathname === undefined) {
                            location.pathname = href.substring(c, i);
                        } else if (search) {
                            location.search = href.substring(search, i);
                        }
                        break;
                    }
                }
                if (location.pathname === undefined) {
                    location.pathname = c === 3 ? href.substr(start) : "";
                    location.search = location.hash = "";
                }
                if (location.search === undefined) {
                    if (search) {
                        location.search = href.substr(search);
                    } else {
                        location.search = "";
                    }
                }
                if (location.hash === undefined) {
                    location.hash = "";
                }
                return location;
            }
        } else {
            function setParseVideo() {
                forElements("video", async (videos, thisInterval) => {
                    for (const video of videos) {
                        if (video.poster) video.removeAttribute("poster");
                        if (video.src) {
                            // è§£ææˆåŠŸï¼Œæ¸…ç©ºè§£æåˆ—è¡¨ç¼“å­˜
                            top.postMessage(key.ENCRYPT("å®å¡”é•‡æ²³å¦–\x00å‡½æ•°\x00settings.address = null", settings.k1, settings.k2), "*");
                            // è®¾ç½®å†å²è§£æ
                            top.postMessage(key.ENCRYPT("å®å¡”é•‡æ²³å¦–\x00å‡½æ•°\x00localStorage.setItem('historyParse', settings.src.get())", settings.k1, settings.k2), "*");

                            // ç§»é™¤å¹¿å‘Šæ¨¡å—
                            removeElements(['document.getElementById("ADplayer")', 'document.getElementById("ADtip")']);
                            // ç­‰å¾…æ•°æ®å¾—åˆ°å“åº”ï¼Œç§»é™¤å¼¹å¹•æ¨¡å—
                            await settings.parseDB;
                            if (settings.parseDB.å¼¹å¹•å¼€å…³ === "\x00") {
                                console.log("æ­£åœ¨ç§»é™¤å¼¹å¹•åŠŸèƒ½");
                                removeElements(['document.querySelector("div[class$=player-video-wrap]").getElementsByTagName("div")', 'document.querySelector("div[class$=player-danmu]")', 'document.querySelector("div[class$=player-danmaku]")', 'document.querySelector("div[class*=player-comment-box]")', 'document.querySelector("div[class*=player-controller-mask]")', 'document.querySelector("[class*=player-list-icon]")', 'document.querySelector("div[class$=player-menu]")']);
                            }

                            // è¿›å…¥å…¨å±
                            const openFullscreen = () => {
                                if (document.body.RequestFullScreen) {
                                    document.body.RequestFullScreen()
                                    //å…¼å®¹Firefox
                                } else if (document.body.mozRequestFullScreen) {
                                    document.body.mozRequestFullScreen()
                                    //å…¼å®¹Chrome, Safari and Operaç­‰
                                } else if (document.body.webkitRequestFullScreen) {
                                    document.body.webkitRequestFullScreen()
                                    //å…¼å®¹IE/Edge
                                } else if (document.body.msRequestFullscreen) {
                                    document.body.msRequestFullscreen()
                                }
                            };

                            // é€€å‡ºå…¨å±
                            const exitFullscreen = () => {
                                if (document.exitFullScreen) {
                                    document.exitFullScreen();
                                    //å…¼å®¹Firefox
                                } else if (document.mozCancelFullScreen) {
                                    document.mozCancelFullScreen();
                                    //å…¼å®¹Chrome, Safari and Operaç­‰
                                } else if (document.webkitExitFullscreen) {
                                    document.webkitExitFullscreen();
                                    //å…¼å®¹IE/Edge
                                } else if (document.body.msExitFullscreen) {
                                    document.body.msExitFullscreen();
                                }
                            };

                            // è·å–å…¨å±èŠ‚ç‚¹
                            const getFullscreenElement = () => {
                                return (
                                    document.fullscreenElement ||
                                    document.mozFullScreenElement ||
                                    document.msFullScreenElement ||
                                    document.webkitFullscreenElement || null
                                );
                            };

                            // åˆ¤æ–­æ˜¯å¦ç§»åŠ¨ç«¯
                            if (!detectMobile()) {
                                let fullscreen_btn = document.querySelector("[class*=fullscreen],[class$=player-full] button[class$=full-icon]");
                                if (fullscreen_btn && fullscreen_btn.nodeType === 1) {
                                    // é˜»æ­¢äº‹ä»¶å†’æ³¡
                                    fullscreen_btn.parentNode.parentNode.onkeyup = event => event.stopPropagation();
                                }
                                video.onkeyup = event => event.stopPropagation();
                                top.postMessage(key.ENCRYPT("å®å¡”é•‡æ²³å¦–\x00æŒ‰ä¸‹Enterè·å–ç„¦ç‚¹", settings.k1, settings.k2), "*")
                                onkeyup = video.onkeyup = event => {
                                    if (event.key === "Enter") {
                                        if (video.paused) {
                                            video.play();
                                        }
                                        if (fullscreen_btn && fullscreen_btn.nodeType === 1) {
                                            fullscreen_btn.click();
                                            return false;
                                        } else if (getFullscreenElement()) {
                                            exitFullscreen();
                                        } else {
                                            openFullscreen();
                                        }
                                    }
                                }
                                focus();
                                if (!sessionStorage.getItem("tipå…¨å±")) {
                                    showTip("æŒ‰ä¸‹Enterå›è½¦é”®ï¼Œè¿›å…¥å…¨å± å¹¶ è‡ªåŠ¨æ’­æ”¾");
                                    sessionStorage.setItem("tipå…¨å±", "\x01");
                                }
                                video.addEventListener("pause", () => {
                                    if ((video.currentTime - video.duration) > -5) {
                                        console.log("è§†é¢‘æ’­æ”¾ç»“æŸäº†");
                                        exitFullscreen();
                                    }
                                }, false);
                            } else {
                                // showTip("è§£ææˆåŠŸ");
                            }

                            // æ¸…é™¤ç›‘å¬videoè®¡æ—¶å™¨
                            clearInterval(thisInterval);
                        }
                    }
                }, 1000, function () {
                    top.postMessage(key.ENCRYPT("å®å¡”é•‡æ²³å¦–\x00ç»™äºˆ\x00-1\x00" + location.href, settings.k1, settings.k2), "*");
                });
            }

            if (location.host.indexOf("jiexi.t7g.cn") !== -1) {
                // ç§»é™¤çˆ±è§£æp2pæç¤º
                displayNone(["body>div#stats"]);
                setParseVideo();
            } else if (location.host.indexOf("api.okjx.cc:3389") !== -1) {
                // åˆ é™¤OKè§£æçº¿è·¯é€‰æ‹©åŠŸèƒ½
                (style => {
                    style.innerHTML = ".slide,.panel,.slide *,.panel *{width: 0 !important; max-width: 0 !important; opacity: 0 !important;}";
                    document.head.appendChild(style);
                })(document.createElement("style"));
                setParseVideo();
            } else if (location.host.indexOf("api.jiubojx.com") !== -1) {
                displayNone("div.adv_wrap_hh");
                setParseVideo();
            } else if (location.host.indexOf("yemu.xyz") !== -1) {
                if (location.pathname.indexOf("jx.php") === -1) {
                    if (location.host.indexOf("www.yemu.xyz") !== -1) {
                        // åˆ é™¤å¤œå¹•è§£æçº¿è·¯é€‰æ‹©åŠŸèƒ½
                        (style => {
                            style.innerHTML = ".slide,.panel,.slide *,.panel *{width: 0 !important; max-width: 0 !important; opacity: 0 !important;}";
                            document.head.appendChild(style);
                        })(document.createElement("style"));
                    } else if (location.host.indexOf("jx.yemu.xyz") !== -1) {
                        // ç§»é™¤è§†é¢‘åˆ†ç±»æç¤º åŠ è§£ææ¡†æ¶å¤„ç†
                        displayNone(["div.advisory"]);
                        setParseVideo();
                    }
                } else {
                    // ç§»é™¤èƒŒæ™¯å›¾ç‰‡
                    doElement("div[style*='width:100%;height:100%;'][style*='.jpg']", background => {
                        background.style = "width:100%;height:100%;position:relative;z-index:2147483647987;";
                    }, 5000);
                }
            } else if (location.host.indexOf('www.mtosz.com') !== -1) {
                displayNone([".video-panel-blur-image"]);    // ä¼¼ä¹ä¸ç®¡ç”¨ï¼Ÿ
                doElement(".video-panel-blur-image", element => {
                    element.style = "display: none; height: 0; width: 0;";
                });
                setParseVideo();
            } else if (location.host.indexOf('v.superchen.top:3389') !== -1) {
                setParseVideo();
            } else if (location.host.indexOf('jx.parwix.com:4433') !== -1) {
                setParseVideo();
            } else if (location.pathname) {
                setParseVideo();
            }
        }


        function displayNone(Tags) {
            let style = document.createElement("style");
            style.innerHTML = "\n";
            for (let i = 0; i < Tags.length; i++) {
                style.innerHTML += Tags[i] + "{display: none !important; height: 0 !important; width: 0 !important; visibility: hidden !important; max-height: 0 !important; max-width: 0 !important; opacity: 0 !important;}\n";
            }
            document.head.insertBefore(style, document.head.firstChild);
        }

        function onLocationChange(handler) {
            let url = top.location.pathname;
            let onLocationChangeInterval = setInterval(() => {
                console.log("æ­£åœ¨ç›‘å¬url")
                let href = top.location.pathname;
                if (href.indexOf(url) === -1) {
                    handler();
                    clearInterval(onLocationChangeInterval);
                } else {
                    url = href;
                }
            }, settings.getElementTimes);
        }

        function onFirstLoad(doFunction) {
            if (document.readyState === "complete") {
                if (doFunction) {
                    doFunction();
                }
            } else {
                setTimeout(() => {
                    onFirstLoad(doFunction);
                }, settings.getElementTimes);
            }
        }

        function searchToJSON(search) {
            if (search) {
                return JSON.parse("{\"" + decodeURIComponent(search.substring(1)
                    .replace(/"/g, '\\"')
                    .replace(/&/g, '","')
                    .replace(/=/g, '":"')) + "\"}");
            } else {
                return null;
            }
        }
    }

    function showTip(msg, style = "") {
        // è¯¥å‡½æ•°éœ€è¦åœ¨topå†…è¿è¡Œï¼Œå¦åˆ™å¯èƒ½æ˜¾ç¤ºå¼‚å¸¸
        if (window === top) {
            let tip = document.querySelector(":root>tip");
            if (tip && tip.nodeType === 1) {
                // é˜²æ­¢ä¸­é€”æ–°çš„showTipäº‹ä»¶åˆ›å»ºå¤šä¸ªtipé€ æˆå¡é¡¿
                root.removeChild(tip);
            }
            tip = document.createElement("tip");
            // pointer-events: none; ç¦ç”¨é¼ æ ‡äº‹ä»¶ï¼Œinputæ ‡ç­¾ä½¿ç”¨ disabled='disabled' ç¦ç”¨inputæ ‡ç­¾
            tip.style = style + "pointer-events: none; opacity: 0; background-color: #222a; color: #fff; font-family: å¾®è½¯é›…é»‘,é»‘ä½“,Droid Serif,Arial,sans-serif; font-size: 20px; text-align: center; padding: 6px; border-radius: 16px; position: fixed; transform: translate(-50%, -50%); left: 50%; bottom: 15%; z-index: 2147483647;";
            tip.innerHTML = "<style>@keyframes showTip {0%{opacity: 0;} 33.34%{opacity: 1;} 66.67%{opacity: 1;} 100%{opacity: 0;}}</style>\n" + msg;
            let time = msg.replace(/\s/, "").length / 2;   // TODO 2ä¸ªå­—/ç§’
            // cubic-bezier(èµ·å§‹ç‚¹, èµ·å§‹ç‚¹åç§»é‡, ç»“æŸç‚¹åç§»é‡, ç»“æŸç‚¹)ï¼Œè¿™é‡Œçš„ cubic-bezierå‡½æ•° è¡¨ç¤ºåŠ¨ç”»é€Ÿåº¦çš„å˜åŒ–è§„å¾‹
            tip.style.animation = "showTip " + (time > 2 ? time : 2) + "s cubic-bezier(0," + ((time - 1) > 0 ? (time - 1) / time : 0) + "," + (1 - ((time - 1) > 0 ? (time - 1) / time : 0)) + ",1) 1 normal";
            root.appendChild(tip);
            setTimeout(() => {
                try {
                    root.removeChild(tip);
                } catch (e) {
                    // æ’é™¤rootæ²¡æœ‰æ‰¾åˆ°tip
                }
            }, time * 1000);
        } else {
            top.postMessage(key.ENCRYPT("å®å¡”é•‡æ²³å¦–\x00å‡½æ•°\x00showTip('" + msg + "')", settings.k1, settings.k2), "*");
        }
    }

    function xmlHttpRequest(settings) {
        let request = new XMLHttpRequest();
        if (settings.success) {
            request.onload = event => {
                // åŠ è½½æˆåŠŸ
                settings.success(request, event);
            }
        }
        if (settings.error) {
            request.onerror = event => {
                // åŠ è½½å¤±è´¥
                settings.error(request, event);
            }
        }
        if (settings.loadend) {
            request.onloadend = event => {
                // åŠ è½½ç»“æŸ
                settings.loadend(request, event);
            }
        }
        if (settings.timeout) {
            request.ontimeout = event => {
                // åŠ è½½è¶…æ—¶
                settings.timeout(request, event);
            }
        }
        request.open(settings.method ? settings.method : "GET", settings.url ? settings.url : location.href, settings.async ? settings.async : true, settings.username ? settings.username : null, settings.password ? settings.password : null);
        if (settings.headers) {
            for (let header in settings.headers) {
                request.setRequestHeader(header, settings[header]);
            }
        }
        if (settings.dataType) {
            request.responseType = settings.dataType;
        }
        if (settings.data) {
            let data = "";
            for (let key in settings.data) {
                data += key + "=" + settings.data[key] + "&";
            }
            data = data.substr(0, data.length - 1);
            request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
            request.send(data);
        } else {
            request.send();
        }
        return request;
    }
});}()
</script></body>`);
        console.log("[æ²¹çŒ´è„šæœ¬] å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js æ³¨å…¥æˆåŠŸ!");
    }
    $done({body});
} catch (err) {
    console.log("[æ²¹çŒ´è„šæœ¬] å…¨ç½‘VIPè§†é¢‘è‡ªåŠ¨è§£ææ’­æ”¾å™¨(å·²é€‚é…æ‰‹æœº).user.js æ‰§è¡Œå¤±è´¥!\n" + err);
    $done({});
}
